import urllibimport timeimport datetimedef myfloat(z1):  z=''  for c in z1:    if ord(c)<128:      z=z+c  # print 'z='+z+'.'  if z[0]=='-':    return 0  else:    return float(z.replace(',' ,'')) def lire_hist_isin(isin):  today=datetime.date.today()  since=today+datetime.timedelta(days=-365)  l1=time.localtime(time.mktime(since.timetuple()))  l2=time.localtime(time.mktime(today.timetuple()))  # print 'l1=',l1,l1[2]  j1="%02d"%l1[2]  m1="%02d"%l1[1]  a1="%02d"%l1[0]  d1=j1+'/'+m1+'/'+a1  j2="%02d"%l2[2]  m2="%02d"%l2[1]  a2="%02d"%l2[0]  d2=j2+'/'+m2+'/'+a2  url = 'http://www.euronext.com/tools/datacentre/dataCentreDownloadExcell.jcsv?lan=FR&cha=2593&fileFormat=txt&separator=.&dateFormat=dd/MM/yy&isinCode='+isin+'&selectedMep=1&indexCompo=&opening=on&high=on&low=on&closing=on&volume=on&dateFrom='+d1+'&dateTo='+d2+'&typeDownload=2'  page = urllib.urlopen(url)  texte = page.read()  return textedef lire_hist_isin_jours(isin,j1,j2):  today=datetime.date.today()  since=today+datetime.timedelta(days=j1)  to=today+datetime.timedelta(days=j2)  l1=time.localtime(time.mktime(since.timetuple()))  l2=time.localtime(time.mktime(to.timetuple()))  # print 'l1=',l1,l1[2]  # print l1  # print l2  j1="%02d"%l1[2]  m1="%02d"%l1[1]  a1="%02d"%l1[0]  d1=j1+'/'+m1+'/'+a1  j2="%02d"%l2[2]  m2="%02d"%l2[1]  a2="%02d"%l2[0]  d2=j2+'/'+m2+'/'+a2  url = 'http://www.euronext.com/tools/datacentre/dataCentreDownloadExcell.jcsv?lan=FR&cha=2593&fileFormat=txt&separator=.&dateFormat=dd/MM/yy&isinCode='+isin+'&selectedMep=1&indexCompo=&opening=on&high=on&low=on&closing=on&volume=on&dateFrom='+d1+'&dateTo='+d2+'&typeDownload=2'  page = urllib.urlopen(url)  texte = page.read()  return textedef nom_isin(isin):  for x in srd:    if x[0]==isin:      return x[1]  return isindef isin_nom(nom):  for x in srd:    # if x[1]==nom:    if x[1].find(nom)==0:      return x[0]  return nomdef cours_isin(isin):  t=lire_hist_isin(isin)  nom=nom_isin(isin)  l1=t.split('\n')  l=l1[6:len(l1)-1]  # lcs=[[isin,nom]+[float(y) for y in x.split(';')] for x in l]  lcs=[]  for x in l:    y=x.split(';')    lcs=lcs+[[isin,nom,x[0]]+[myfloat(z) for z in y[1:len(y)]]]  return lcsdef cours_isin_jours(isin,j1,j2):  t=lire_hist_isin_jours(isin,j1,j2)  # nom=nom_isin(isin)  l1=t.split('\n')  infos = l1[3].split(';')   nom = infos[0]  l=l1[6:len(l1)-1]  # lcs=[[isin,nom]+[myfloat(y) for y in x.split(';')] for x in l]  lcs=[]  for x in l:    y=x.split(';')    lcs=lcs+[[isin,nom,y[0]]+[myfloat(z) for z in y[1:len(y)]]]  return lcsdef cours_nom(nom):  return cours_isin(isin_nom(nom))def cours_nom_jours(nom,j1,j2):  return cours_isin_jours(isin_nom(nom),j1,j2)